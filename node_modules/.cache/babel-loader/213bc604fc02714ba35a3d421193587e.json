{"ast":null,"code":"import _createForOfIteratorHelper from\"/Users/constantine/Dev/FrontEnd/progress/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import Localbase from\"localbase\";import QuestionData,{version}from\"../450DSAFinal\";var db=new Localbase(\"db\");window.db=db;db.config.debug=false;var localVersion=localStorage.getItem(\"450version\");window.localVersion=localVersion;window.version=version;export function insertData(callback){QuestionData.forEach(function(topic,index){db.collection(\"450dsaArchive\").add(topic,topic.topicName.replace(/[^A-Z0-9]+/gi,\"_\").toLowerCase());});getData(callback);}export function getData(callback){db.collection(\"450dsaArchive\").get().then(function(data){if(data.length===0){insertData(callback);}else{data.sort(function(a,b){return a.position-b.position;});if(localVersion===null||localVersion===undefined){localStorage.setItem(\"450version\",100000000);setTimeout(function(){window.location.reload();},3000);}if(parseInt(localVersion)!==version){var i=0;var _iterator=_createForOfIteratorHelper(data),_step;try{var _loop=function _loop(){var topic=_step.value;var dataFromJSON=QuestionData[i].questions;var len=dataFromJSON.length;var key=topic.topicName.replace(/[^A-Z0-9]+/gi,\"_\").toLowerCase();topic.questions.forEach(function(qObj,index){if(index<len){if(qObj.Done){dataFromJSON[index][\"Done\"]=true;}if(qObj.hasOwnProperty(\"Bookmark\")){dataFromJSON[index][\"Bookmark\"]=qObj.Bookmark;}else{dataFromJSON[index][\"Bookmark\"]=false;}if(qObj.hasOwnProperty(\"Notes\")){dataFromJSON[index][\"Notes\"]=qObj.Notes;}else{dataFromJSON[index][\"Notes\"]=\"\";}}});updateDBData(key,{started:topic.started,doneQuestions:topic.doneQuestions,questions:dataFromJSON});i++;};for(_iterator.s();!(_step=_iterator.n()).done;){_loop();}}catch(err){_iterator.e(err);}finally{_iterator.f();}localStorage.setItem(\"450version\",version);setTimeout(function(){window.location.reload();},3000);}else{return callback(data);}}});}export function getTopicData(key,callback){db.collection(\"450dsaArchive\").doc(key).get().then(function(document){callback(document);});}export function updateDBData(key,updateData){db.collection(\"450dsaArchive\").doc(key).update(updateData);}export function resetDBData(callback){db.collection(\"450dsaArchive\").delete().then(function(response){callback(response);}).catch(function(error){console.log(\"There was an error, do something else\",error);});}export function exportDBData(callback){db.collection(\"450dsaArchive\").get().then(function(data){callback(data);});}export function importDBData(data,callback){resetDBData(function(response){new Promise(function(resolve,reject){data.forEach(function(topic,index){db.collection(\"450dsaArchive\").add(topic,topic.topicName.replace(/[^A-Z0-9]+/gi,\"_\").toLowerCase());if(index===data.length-1){resolve();}});}).then(function(){getData(function(data){callback(data);});});});}","map":{"version":3,"sources":["/Users/constantine/Dev/FrontEnd/progress/src/services/dbServices.js"],"names":["Localbase","QuestionData","version","db","window","config","debug","localVersion","localStorage","getItem","insertData","callback","forEach","topic","index","collection","add","topicName","replace","toLowerCase","getData","get","then","data","length","sort","a","b","position","undefined","setItem","setTimeout","location","reload","parseInt","i","dataFromJSON","questions","len","key","qObj","Done","hasOwnProperty","Bookmark","Notes","updateDBData","started","doneQuestions","getTopicData","doc","document","updateData","update","resetDBData","delete","response","catch","error","console","log","exportDBData","importDBData","Promise","resolve","reject"],"mappings":"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","sourcesContent":["import Localbase from \"localbase\";\nimport QuestionData, { version } from \"../450DSAFinal\";\nlet db = new Localbase(\"db\");\nwindow.db = db;\ndb.config.debug = false;\nconst localVersion = localStorage.getItem(\"450version\");\nwindow.localVersion = localVersion;\nwindow.version = version;\n\nexport function insertData(callback) {\n\tQuestionData.forEach((topic, index) => {\n\t\tdb.collection(\"450dsaArchive\").add(topic, topic.topicName.replace(/[^A-Z0-9]+/gi, \"_\").toLowerCase());\n\t});\n\tgetData(callback);\n}\n\nexport function getData(callback) {\n\tdb.collection(\"450dsaArchive\")\n\t\t.get()\n\t\t.then((data) => {\n\t\t\tif (data.length === 0) {\n\t\t\t\tinsertData(callback);\n\t\t\t} else {\n\t\t\t\tdata.sort((a, b) => {\n\t\t\t\t\treturn a.position - b.position;\n\t\t\t\t});\n\t\t\t\tif (localVersion === null || localVersion === undefined) {\n\t\t\t\t\tlocalStorage.setItem(\"450version\", 100000000);\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t}, 3000);\n\t\t\t\t}\n\n\t\t\t\tif (parseInt(localVersion) !== version) {\n\t\t\t\t\tlet i = 0;\n\t\t\t\t\tfor (let topic of data) {\n\t\t\t\t\t\tlet dataFromJSON = QuestionData[i].questions;\n\t\t\t\t\t\tlet len = dataFromJSON.length;\n\t\t\t\t\t\tlet key = topic.topicName.replace(/[^A-Z0-9]+/gi, \"_\").toLowerCase();\n\t\t\t\t\t\ttopic.questions.forEach((qObj, index) => {\n\t\t\t\t\t\t\tif (index < len) {\n\t\t\t\t\t\t\t\tif (qObj.Done) {\n\t\t\t\t\t\t\t\t\tdataFromJSON[index][\"Done\"] = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (qObj.hasOwnProperty(\"Bookmark\")) {\n\t\t\t\t\t\t\t\t\tdataFromJSON[index][\"Bookmark\"] = qObj.Bookmark;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tdataFromJSON[index][\"Bookmark\"] = false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (qObj.hasOwnProperty(\"Notes\")) {\n\t\t\t\t\t\t\t\t\tdataFromJSON[index][\"Notes\"] = qObj.Notes;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tdataFromJSON[index][\"Notes\"] = \"\";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tupdateDBData(key, {\n\t\t\t\t\t\t\tstarted: topic.started,\n\t\t\t\t\t\t\tdoneQuestions: topic.doneQuestions,\n\t\t\t\t\t\t\tquestions: dataFromJSON,\n\t\t\t\t\t\t});\n\t\t\t\t\t\ti++;\n\t\t\t\t\t}\n\t\t\t\t\tlocalStorage.setItem(\"450version\", version);\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t}, 3000);\n\t\t\t\t} else {\n\t\t\t\t\treturn callback(data);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n}\n\nexport function getTopicData(key, callback) {\n\tdb.collection(\"450dsaArchive\")\n\t\t.doc(key)\n\t\t.get()\n\t\t.then((document) => {\n\t\t\tcallback(document);\n\t\t});\n}\n\nexport function updateDBData(key, updateData) {\n\tdb.collection(\"450dsaArchive\").doc(key).update(updateData);\n}\n\nexport function resetDBData(callback) {\n\tdb.collection(\"450dsaArchive\")\n\t\t.delete()\n\t\t.then((response) => {\n\t\t\tcallback(response);\n\t\t})\n\t\t.catch((error) => {\n\t\t\tconsole.log(\"There was an error, do something else\", error);\n\t\t});\n}\n\nexport function exportDBData(callback) {\n\tdb.collection(\"450dsaArchive\")\n\t\t.get()\n\t\t.then((data) => {\n\t\t\tcallback(data);\n\t\t});\n}\n\nexport function importDBData(data, callback) {\n\tresetDBData((response) => {\n\t\tnew Promise((resolve, reject) => {\n\t\t\tdata.forEach((topic, index) => {\n\t\t\t\tdb.collection(\"450dsaArchive\").add(topic, topic.topicName.replace(/[^A-Z0-9]+/gi, \"_\").toLowerCase());\n\t\t\t\tif (index === data.length - 1) {\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t});\n\t\t}).then(() => {\n\t\t\tgetData((data) => {\n\t\t\t\tcallback(data);\n\t\t\t});\n\t\t});\n\t});\n}\n"]},"metadata":{},"sourceType":"module"}